function S(s,e){let t=document.createElement("template");if(t.innerHTML=s,e){let l=t.content,n=l.childNodes[0],i=n.childNodes,a=i.length;for(n.remove();a--;)l.appendChild(i[0])}return t}function $(s){return document.importNode(s.content,!0)}function u(s,e){let t=s,l=0,n=e.length,i,a;for(;l<n;l++)for(i=e[l],t=t.firstChild,a=0;a<i;a++)t=t.nextSibling;return t}function le(s,e,t){if(s.replaceWith(e),t){let l=s.childNodes,n=l.length;for(;n--;)e.appendChild(l[0])}}function T(s,e){s.append(e)}function j(s,e){s.after(e)}function se(s,e){let t=s;if(e.nextSibling!==s)for(;t;){let l=t;if(t=t.nextSibling,l.remove(),l===e)break}}function k(s,e,t,l){s.addEventListener(e,t,l)}function ne(s,e,t){s.setAttribute(e,t)}function A(s,e,t){s.classList.toggle(e,t)}var q=Object,Fe=Symbol,ze=/\B([A-Z])/g;function de(s){return s.replace(ze,"-$1").toLowerCase()}var ve=q.is,Qe=q.assign,ae=s=>typeof s=="function";var o,y=1<<0,E=1<<1,N=1<<2,B=1<<3,Y=1<<4,P=1<<5,_,h,C,D=0,te=0,K=0;function _e(){D++}function me(){if(D>1){D--;return}let s,e=!1;for(;C;){let t=C.sort((l,n)=>l.h-n.h);C=o,te++;for(let l=0,n=t.length;l<n;l++){let i=t[l];i.c&=~N;try{i.s()}catch(a){e||(s=a,e=!0)}}}if(te=0,D--,e)throw s}function ge(s){let e;if(h)if(e=s.k,!e||e.p!==h)e={d:0,c:0,m:o,g:s,e:h.b,i:o,p:h,j:o,n:o},h.b=e,s.k=e,h.c&Y&&s.o(e);else if(e.c&E){e.c&=~E;let t=h.b,l=e.i,n=e.e;e!==t&&(l&&(l.e=n),n&&(n.i=l),t&&(t.i=e),e.i=o,e.e=t,h.b=e)}else e=o;try{return s.peek()}finally{e&&(e.d=s.d)}}function ee(s){if(s.c&=~y,s.c&B)throw s.a;return s.a}function be(s){for(let e=s.b;e;e=e.e){let t=e.g.k;t&&(e.m=t),e.g.k=e,e.c|=E}}function ye(s){let e=s.b,t;for(;e;){let l=e.e;e.c&E?(e.g.l(e),e.e=o):(t&&(t.i=e),e.i=o,e.e=t,t=e),e.g.k=e.m,e.m&&(e.m=o),e=l}s.b=t}function Ve(s){let e=this;ye(e),h=s,me(),e.c&=~y}var R=class{constructor(e){let t=this;t.d=0,t.a=e,t.k=o,t.f=o}o(e){let t=this;e.c&P||(e.c|=P,e.j=t.f,t.f&&(t.f.n=e),t.f=e)}l(e){let t=this,l=e.n,n=e.j;e.c&P&&(e.c&=~P,l&&(l.j=n,e.n=o),n&&(n.n=l,e.j=o),e===t.f&&(t.f=n))}subscribe(e){let t=this;return d(function(){let l=t.value,n=h;h=o;try{return e(l)}finally{h=n}})}set(e){return this.value=e}peek(){return this.a}get value(){return ge(this)}set value(e){let t=this;if(e!==t.a){if(t.a=e,te>100)return;t.d++,K++,_e();try{for(let l=t.f;l;l=l.j)l.p.q()}finally{me()}}}},G=class extends R{constructor(e){super(o),this.r=e,this.b=o,this.c=E,this.t=K-1}o(e){let t=this;if(!t.f){t.c|=E|Y;for(let l=t.b;l;l=l.e)l.g.o(l)}super.o(e)}l(e){let t=this;if(super.l(e),!t.f){t.c&=~Y;for(let l=t.b;l;l=l.e)l.g.l(l)}}q(){let e=this;if(!(e.c&(N|y))){e.c|=E|N;for(let t=e.f;t;t=t.j)t.p.q()}}peek(){let e=this;if(e.c&=~N,e.c&y)return e.a;if(e.c|=y,!(e.c&E)&&e.f||e.t===K)return ee(e);if(e.c&=~E,e.t=K,e.d>0){let i=e.b;for(;i&&i.g.d===i.d;){try{i.g.peek()}catch{}if(i.g.d!==i.d)break;i=i.e}if(!i)return ee(e)}let t=e.a,l=e.c,n=h;try{h=e,be(e),e.a=e.r(),e.c&=~B,(l&B||e.a!==t||e.d===0)&&e.d++}catch(i){e.a=i,e.c|=B,e.d++}finally{ye(e),h=n}return ee(e)}get value(){let e=this;return e.c&y?e.a:ge(e)}set value(e){super.value=e}},U=class{constructor(e){this.r=e,this.b=o,this.h=0,this.c=Y}s(){let e=this;if(e.c&y)return;let t=e.u();try{e.r()}finally{t()}}u(){let e=this,t=h;return e.c|=y,_e(),h=e,be(e),Ve.bind(e,t)}q(){let e=this;e.c&(N|y)||(e.c|=N,C||(C=[]),C.push(e))}v(){let e=this;for(let t=e.b;t;t=t.e)t.g.l(t);e.c|=y,e.b=o}},J=class{constructor(e){let t=this;t.scopes=[],t.cleanups=[],t.parent=o,t.h=0,!e&&_&&(t.parent=_,t.h=_.h+1,_.scopes.push(t))}run(e){let t=_;try{return _=this,e()}finally{_=t}}clear(){let e=this,t=e.scopes,l=e.cleanups;for(let n of t)n.clear(),n.parent=o;for(let n of l)n();t.length=0,l.length=0}};function I(s){return new J(s)}function ie(s){ae(s)&&_&&_.cleanups.push(s)}function x(s){return new R(s)}function F(s){return new G(s)}function d(s){let e=new U(s),t=e.v.bind(e);try{e.s()}catch(l){throw t(),l}return _&&e.b&&(e.h=_.h,_.cleanups.push(t)),t}var Xe=!1,Ze=1;var M=null,ke=Fe(),W=class extends HTMLElement{$m=!1;$c=I(!0);$p={};$h=[];constructor(){super();let e=this,t=e.$p,l=e.constructor.$d;for(let n in l){let i=l[n];t[i]=x(ke)}}connectedCallback(){let e=this;if(!e.$m){e.$m=!0;let t=e.constructor.$c,l=e.constructor.$s,n=e.$c,i=e.$h,a=e.shadowRoot,p=!1;a||(a=e.attachShadow({mode:"open"}),p=!0);let v=M;try{if(M=e,n.run(()=>t(a,e)),document.adoptedStyleSheets)p&&(a.adoptedStyleSheets=l);else for(let f of l)T(a,f.cloneNode(!0));for(let f of i){let g=f();ae(g)&&n.cleanups.push(g)}i.length=0}finally{M=v}}}disconnectedCallback(){let e=this;e.$m&&(e.$c.clear(),e.shadowRoot.innerHTML="",e.$m=!1)}attributeChangedCallback(e,t,l){let n=this,i=n.constructor.$d;e in i&&(n.$p[i[e]].value=l===""?!0:l)}};function re(s,e,t,l){let n=[],i=q.create(null);class a extends W{static observedAttributes=n;static $c=e;static $a=i;static $d=t;static $s=l}for(let p in t){let v=t[p],f=de(p);i[f]=p,n.push(f),q.defineProperty(a.prototype,p,{get(){return this.$p[v].a},set(g){this.$p[v].value=g}})}return Xe&&(s="velvet-"+Ze++),s&&customElements.define(s,a),a}function z(s,e){let t=document.createTextNode("");s.nodeType===1?T(s,t):le(s,t,!1),d(()=>t.data=e())}function Q(s,e){let t=I(),l,n;d(()=>{let i=e();i!==l&&(n&&(t.clear(),Ee(s,n),n=null),l=i,i&&(n=t.run(()=>i(s))))})}function we(s,e,t){let l=[],n=_.h+1;d(()=>{let i=t(),a=0,p=i.length,v=l.length;for(;a<p;a++)if(l[a]){let f=l[a][2];f.value=i[a]}else{let f=l[a-1],g=f?f[1]:s,w=x(i[a]),O=I(!0);O.h=n,l[a]=[O,O.run(()=>e(g,w,a)),w]}if(v>p){let f=l[a-1],g=f?f[1]:s,w=l[v-1][1];for(;a<v;a++)l[a][0].clear();Ee(g,w),l.length=p}}),ie(()=>{for(let i=0,a=l.length;i<a;i++)l[i][0].clear()})}function Ee(s,e){se(s.nextSibling,e)}var tt=S("<header class=header><h1>todos</h1><input class=new-todo placeholder='What needs to be done?'autofocus></header>"),lt=S("<section class=main><input id=toggle-all class=toggle-all type=checkbox><label for=toggle-all>Mark all as complete</label><ul class=todo-list><!></ul><footer class=footer><span class=todo-count> <strong></strong> <!> left </span><ul class=filters><li><a href=#/>All</a></li><li><a href=#/active>Active</a></li><li><a href=#/completed>Completed</a></li></ul></footer></section>"),st=S("<li><div class=view><input class=toggle type=checkbox><label><!></label><button class=destroy></button></div> <!></li>"),nt=S("<input class=edit>"),at=S("<button class=clear-completed>Clear completed</button>");function it(s,e){let n="todos",i={all:r=>r,active:r=>r.filter(c=>!c.completed),completed:r=>r.filter(c=>c.completed)},a=x(JSON.parse(localStorage.getItem(n)||"[]")),p=x("all"),v=x(null),f=x(null),g=F(()=>i[p.value](a.value)),w=F(()=>i.active(a.value).length),O=r=>{a.value=a.value.map(c=>({...c,completed:r.target.checked}))},xe=()=>{a.value=a.value.filter(r=>!r.completed)},Se=r=>{r.which===13&&(a.value=a.value.concat({id:Date.now(),title:r.target.value,completed:!1}),r.target.value="")},$e=r=>{a.value=a.value.filter(c=>c.id!==r)},oe=r=>{a.value=a.value.map(c=>c.id!==r.id?c:{...c,...r})},Ae=(r,c)=>{oe({id:r,completed:c.target.checked})},Ne=r=>{r.which===13?r.target.blur():r.which===27&&(v.value=null,f.value=null)},Ce=r=>{oe({id:v.value,title:r.target.value}),v.value=null,f.value=null},ue=()=>{let r=window.location.hash.replace(/#\/?/,"");i[r]||(r="all"),p.value=r};window.addEventListener("hashchange",ue),ue(),d(()=>localStorage.setItem(n,JSON.stringify(a.value))),d(()=>{f.value&&setTimeout(()=>f.value.focus())});let V=$(tt),Re=u(V,[0,1]),Te=u(V,[0]),je=r=>{let c=$(lt),fe=u(c,[0,0]),Oe=u(c,[0,2,0]),Le=u(c,[0,3,0,1]),Ie=u(c,[0,3,0,3]),He=u(c,[0,3,1,0,0]),Pe=u(c,[0,3,1,1,0]),Be=u(c,[0,3,1,2,0]),De=u(c,[0,3,1]),Ke=u(c,[0]),Me=(X,m)=>{let b=$(st),pe=u(b,[0,0,0]),Ye=u(b,[0,0,1,0]),Ge=u(b,[0,0,1]),Ue=u(b,[0,0,2]),Je=u(b,[0,2]),H=u(b,[0]),We=Z=>{let he=$(nt),L=u(he,[0]);return f.value=L,d(()=>L.value=m.value.title),k(L,"keydown",Ne),k(L,"blur",Ce),j(Z,he),L};return d(()=>pe.checked=m.value.completed),k(pe,"change",Z=>Ae(m.value.id,Z)),z(Ye,()=>m.value.title),k(Ge,"dblclick",()=>v.value=m.value.id),k(Ue,"click",()=>$e(m.value.id)),Q(Je,()=>v.value===m.value.id?We:null),ne(H,"class","todo"),d(()=>A(H,"completed",m.value.completed)),d(()=>A(H,"editing",v.value===m.value.id)),j(X,b),H},qe=X=>{let m=$(at),b=u(m,[0]);return k(b,"click",xe),j(X,m),b};return d(()=>fe.checked=w.value===0),k(fe,"change",O),we(Oe,Me,()=>g.value),z(Le,()=>w.value),z(Ie,()=>w.value===1?"item":"items"),d(()=>A(He,"selected",p.value==="all")),d(()=>A(Pe,"selected",p.value==="active")),d(()=>A(Be,"selected",p.value==="completed")),Q(De,()=>a.value.length>w.value?qe:null),j(r,c),Ke};k(Re,"keydown",Se),Q(Te,()=>a.value.length>0?je:null),T(s,V)}var ce=re("x-app",it,{},[]);ce.prototype.attachShadow=function(){return this};var rt=new ce;document.body.append(rt);
//# sourceMappingURL=index.js.map

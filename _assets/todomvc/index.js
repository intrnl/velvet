function S(s,e){let t=document.createElement("template");if(t.innerHTML=s,e){let l=t.content,a=l.childNodes[0],i=a.childNodes,n=i.length;for(a.remove();n--;)l.appendChild(i[0])}return t}function $(s){return document.importNode(s.content,!0)}function u(s,e){let t=s,l=0,a=e.length,i,n;for(;l<a;l++)for(i=e[l],t=t.firstChild,n=0;n<i;n++)t=t.nextSibling;return t}function le(s,e,t){if(s.replaceWith(e),t){let l=s.childNodes,a=l.length;for(;a--;)e.appendChild(l[0])}}function T(s,e){s.append(e)}function j(s,e){s.after(e)}function se(s,e){let t=s;if(e.nextSibling!==s)for(;t;){let l=t;if(t=t.nextSibling,l.remove(),l===e)break}}function k(s,e,t,l){s.addEventListener(e,t,l)}function ae(s,e,t){s.setAttribute(e,t)}function A(s,e,t){s.classList.toggle(e,t)}var q=Object,ze=Symbol,Qe=/\B([A-Z])/g;function de(s){return s.replace(Qe,"-$1").toLowerCase()}var ve=q.is,Ve=q.assign,ne=s=>typeof s=="function";var o,y=1<<0,x=1<<1,N=1<<2,B=1<<3,Y=1<<4,P=1<<5,_,p,C,D=0,te=0,K=0;function _e(){D++}function ge(){if(D>1){D--;return}let s,e=!1;for(;C;){let t=C.sort((l,a)=>l.h-a.h);C=o,te++;for(let l=0,a=t.length;l<a;l++){let i=t[l];i.c&=~N;try{i.s()}catch(n){e||(s=n,e=!0)}}}if(te=0,D--,e)throw s}function me(s){let e;if(p)if(e=s.k,!e||e.p!==p)e={d:0,c:0,m:o,g:s,e:p.b,i:o,p,j:o,n:o},p.b=e,s.k=e,p.c&Y&&s.o(e);else if(e.c&x){e.c&=~x;let t=p.b,l=e.i,a=e.e;e!==t&&(l&&(l.e=a),a&&(a.i=l),t&&(t.i=e),e.i=o,e.e=t,p.b=e)}else e=o;try{return s.peek()}finally{e&&(e.d=s.d)}}function ee(s){if(s.c&=~y,s.c&B)throw s.a;return s.a}function be(s){for(let e=s.b;e;e=e.e){let t=e.g.k;t&&(e.m=t),e.g.k=e,e.c|=x}}function ye(s){let e=s.b,t;for(;e;){let l=e.e;e.c&x?(e.g.l(e),e.e=o):(t&&(t.i=e),e.i=o,e.e=t,t=e),e.g.k=e.m,e.m&&(e.m=o),e=l}s.b=t}function We(s){let e=this;ye(e),p=s,ge(),e.c&=~y}var R=class{constructor(e){let t=this;t.d=0,t.a=e,t.k=o,t.f=o}o(e){let t=this;e.c&P||(e.c|=P,e.j=t.f,t.f&&(t.f.n=e),t.f=e)}l(e){let t=this,l=e.n,a=e.j;e.c&P&&(e.c&=~P,l&&(l.j=a,e.n=o),a&&(a.n=l,e.j=o),e===t.f&&(t.f=a))}subscribe(e){let t=this;return d(function(){let l=t.value,a=p;p=o;try{return e(l)}finally{p=a}})}set(e){return this.value=e}peek(){return this.a}get value(){return me(this)}set value(e){let t=this;if(e!==t.a){if(t.a=e,te>100)return;t.d++,K++,_e();try{for(let l=t.f;l;l=l.j)l.p.q()}finally{ge()}}}},G=class extends R{constructor(e){super(o),this.r=e,this.b=o,this.c=x,this.t=K-1}o(e){let t=this;if(!t.f){t.c|=x|Y;for(let l=t.b;l;l=l.e)l.g.o(l)}super.o(e)}l(e){let t=this;if(super.l(e),!t.f){t.c&=~Y;for(let l=t.b;l;l=l.e)l.g.l(l)}}q(){let e=this;if(!(e.c&(N|y))){e.c|=x|N;for(let t=e.f;t;t=t.j)t.p.q()}}peek(){let e=this;if(e.c&=~N,e.c&y)return e.a;if(e.c|=y,!(e.c&x)&&e.f||e.t===K)return ee(e);if(e.c&=~x,e.t=K,e.d>0){let i=e.b;for(;i&&i.g.d===i.d;){try{i.g.peek()}catch{}if(i.g.d!==i.d)break;i=i.e}if(!i)return ee(e)}let t=e.a,l=e.c,a=p;try{p=e,be(e),e.a=e.r(),e.c&=~B,(l&B||e.a!==t||e.d===0)&&e.d++}catch(i){e.a=i,e.c|=B,e.d++}finally{ye(e),p=a}return ee(e)}get value(){let e=this;return e.c&y?e.a:me(e)}set value(e){super.value=e}},U=class{constructor(e){this.r=e,this.b=o,this.h=0,this.c=Y}s(){let e=this;if(e.c&y)return;let t=e.u();try{e.r()}finally{t()}}u(){let e=this,t=p;return e.c|=y,_e(),p=e,be(e),We.bind(e,t)}q(){let e=this;e.c&(N|y)||(e.c|=N,C||(C=[]),C.push(e))}v(){let e=this;for(let t=e.b;t;t=t.e)t.g.l(t);e.c|=y,e.b=o}},J=class{constructor(e){let t=this;t.scopes=[],t.cleanups=[],t.parent=o,t.h=0,!e&&_&&(t.parent=_,t.h=_.h+1,_.scopes.push(t))}run(e){let t=_;try{return _=this,e()}finally{_=t}}clear(){let e=this,t=e.scopes,l=e.cleanups;for(let a of t)a.clear(),a.parent=o;for(let a of l)a();t.length=0,l.length=0}};function I(s){return new J(s)}function ie(s){ne(s)&&_&&_.cleanups.push(s)}function E(s){return new R(s)}function z(s){return new G(s)}function d(s){let e=new U(s),t=e.v.bind(e);try{e.s()}catch(l){throw t(),l}return _&&e.b&&(e.h=_.h,_.cleanups.push(t)),t}var Ze=!1,Xe=1;var M=null,ke=ze(),F=class extends HTMLElement{$m=!1;$c=I(!0);$p={};$h=[];constructor(){super();let e=this,t=e.$p,l=e.constructor.$d;for(let a in l){let i=l[a];t[i]=E(ke)}}connectedCallback(){let e=this;if(!e.$m){e.$m=!0;let t=e.constructor.$c,l=e.constructor.$s,a=e.$c,i=e.$h,n=e.shadowRoot,h=!1;n||(n=e.attachShadow({mode:"open"}),h=!0);let v=M;try{if(M=e,a.run(()=>t(n,e)),document.adoptedStyleSheets)h&&(n.adoptedStyleSheets=l);else for(let f of l)T(n,f.cloneNode(!0));for(let f of i){let m=f();ne(m)&&a.cleanups.push(m)}i.length=0}finally{M=v}}}disconnectedCallback(){let e=this;e.$m&&(e.$c.clear(),e.shadowRoot.innerHTML="",e.$m=!1)}attributeChangedCallback(e,t,l){let a=this,i=a.constructor.$d;e in i&&(a.$p[i[e]].value=l===""?!0:l)}};function re(s,e,t,l){let a=[],i=q.create(null);class n extends F{static observedAttributes=a;static $c=e;static $a=i;static $d=t;static $s=l}for(let h in t){let v=t[h],f=de(h);i[f]=h,a.push(f),q.defineProperty(n.prototype,h,{get(){return this.$p[v].a},set(m){this.$p[v].value=m}})}return Ze&&(s="velvet-"+Xe++),s&&customElements.define(s,n),n}function Q(s,e){let t=document.createTextNode("");s.nodeType===1?T(s,t):le(s,t,!1),d(()=>t.data=e())}function V(s,e){let t=I(),l,a;d(()=>{let i=e();i!==l&&(a&&(t.clear(),xe(s,a),a=null),l=i,i&&(a=t.run(()=>i(s))))})}function we(s,e,t){let l=[],a=_.h+1;d(()=>{let i=t(),n=0,h=i.length,v=l.length;for(;n<h;n++)if(l[n]){let f=l[n][2];f.value=i[n]}else{let f=l[n-1],m=f?f[1]:s,w=E(i[n]),O=I(!0);O.h=a,l[n]=[O,O.run(()=>e(m,w,n)),w]}if(v>h){let f=l[n-1],m=f?f[1]:s,w=l[v-1][1];for(;n<v;n++)l[n][0].clear();xe(m,w),l.length=h}}),ie(()=>{for(let i=0,n=l.length;i<n;i++)l[i][0].clear()})}function xe(s,e){se(s.nextSibling,e)}var tt=S("<header class=header><h1>todos</h1><input class=new-todo placeholder='What needs to be done?'autofocus></header>"),lt=S("<section class=main><input id=toggle-all class=toggle-all type=checkbox><label for=toggle-all>Mark all as complete</label><ul class=todo-list><!></ul><footer class=footer><span class=todo-count> <strong></strong> <!> left </span><ul class=filters><li><a href=#/>All</a></li><li><a href=#/active>Active</a></li><li><a href=#/completed>Completed</a></li></ul></footer></section>"),st=S("<li><div class=view><input class=toggle type=checkbox><label><!></label><button class=destroy></button></div> <!></li>"),at=S("<input class=edit>"),nt=S("<button class=clear-completed>Clear completed</button>");function it(s,e){let a="todos",i={all:r=>r,active:r=>r.filter(c=>!c.completed),completed:r=>r.filter(c=>c.completed)},n=E(JSON.parse(localStorage.getItem(a)||"[]")),h=E("all"),v=E(null),f=E(null),m=z(()=>i[h.value](n.value)),w=z(()=>i.active(n.value).length),O=r=>{n.value=n.value.map(c=>({...c,completed:r.target.checked}))},Ee=()=>{n.value=n.value.filter(r=>!r.completed)},Se=r=>{r.which===13&&(n.value=n.value.concat({id:Date.now(),title:r.target.value,completed:!1}),r.target.value="")},$e=r=>{n.value=n.value.filter(c=>c.id!==r)},oe=r=>{n.value=n.value.map(c=>c.id!==r.id?c:{...c,...r})},Ae=(r,c)=>{oe({id:r,completed:c.target.checked})},Ne=r=>{r.which===13?r.target.blur():r.which===27&&(v.value=null,f.value=null)},Ce=r=>{oe({id:v.value,title:r.target.value}),v.value=null,f.value=null},ue=()=>{let r=window.location.hash.replace(/#\/?/,"");i[r]||(r="all"),h.value=r};window.addEventListener("hashchange",ue),ue(),d(()=>localStorage.setItem(a,JSON.stringify(n.value))),d(()=>{f.value&&setTimeout(()=>f.value.focus())});let W=$(tt),Re=u(W,[0,1]),Te=u(W,[0]),je=r=>{let c=$(lt),fe=u(c,[0,0]),Oe=u(c,[0,2,0]),Le=u(c,[0,3,0,1]),Ie=u(c,[0,3,0,3]),He=u(c,[0,3,1,0,0]),Pe=u(c,[0,3,1,1,0]),Be=u(c,[0,3,1,2,0]),De=u(c,[0,3,1]),Ke=u(c,[0]),Me=(Z,g)=>{let b=$(st),he=u(b,[0,0,0]),Ye=u(b,[0,0,1,0]),Ge=u(b,[0,0,1]),Ue=u(b,[0,0,2]),Je=u(b,[0,2]),H=u(b,[0]),Fe=X=>{let pe=$(at),L=u(pe,[0]);return f.value=L,d(()=>L.value=g.value.title),k(L,"keydown",Ne),k(L,"blur",Ce),j(X,pe),L};return d(()=>he.checked=g.value.completed),k(he,"change",X=>Ae(g.value.id,X)),Q(Ye,()=>g.value.title),k(Ge,"dblclick",()=>v.value=g.value.id),k(Ue,"click",()=>$e(g.value.id)),V(Je,()=>v.value===g.value.id?Fe:null),ae(H,"class","todo"),d(()=>A(H,"completed",g.value.completed)),d(()=>A(H,"editing",v.value===g.value.id)),j(Z,b),H},qe=Z=>{let g=$(nt),b=u(g,[0]);return k(b,"click",Ee),j(Z,g),b};return d(()=>fe.checked=w.value===0),k(fe,"change",O),we(Oe,Me,()=>m.value),Q(Le,()=>w.value),Q(Ie,()=>w.value===1?"item":"items"),d(()=>A(He,"selected",h.value==="all")),d(()=>A(Pe,"selected",h.value==="active")),d(()=>A(Be,"selected",h.value==="completed")),V(De,()=>n.value.length>w.value?qe:null),j(r,c),Ke};k(Re,"keydown",Se),V(Te,()=>n.value.length>0?je:null),T(s,W)}var ce=re("x-app",it,{},[]);ce.prototype.attachShadow=function(){return this};var rt=new ce;document.body.append(rt);
//# sourceMappingURL=index.js.map

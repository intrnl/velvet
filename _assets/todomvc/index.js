function S(l){let e=document.createElement("template");return e.innerHTML=l,e}function $(l){return document.importNode(l.content,!0)}function u(l,e){let t=l,s=0,n=e.length,i,a;for(;s<n;s++)for(i=e[s],t=t.firstChild,a=0;a<i;a++)t=t.nextSibling;return t}function le(l,e,t){if(l.replaceWith(e),t){let s=l.childNodes,n=s.length;for(;n--;)e.appendChild(s[0])}}function T(l,e){l.append(e)}function j(l,e){l.after(e)}function se(l,e){let t=l;if(e.nextSibling!==l)for(;t;){let s=t;if(t=t.nextSibling,s.remove(),s===e)break}}function k(l,e,t,s){l.addEventListener(e,t,s)}function ae(l,e,t){l.setAttribute(e,t)}function A(l,e,t){l.classList.toggle(e,t)}var q=Object,ze=Symbol,Qe=/\B([A-Z])/g;function de(l){return l.replace(Qe,"-$1").toLowerCase()}var ve=q.is,Ve=q.assign,ne=l=>typeof l=="function";var o,y=1<<0,E=1<<1,C=1<<2,B=1<<3,Y=1<<4,P=1<<5,_,p,N,D=0,te=0,K=0;function _e(){D++}function ge(){if(D>1){D--;return}let l,e=!1;for(;N;){let t=N.sort((s,n)=>s.h-n.h);N=o,te++;for(let s=0,n=t.length;s<n;s++){let i=t[s];i.c&=~C;try{i.s()}catch(a){e||(l=a,e=!0)}}}if(te=0,D--,e)throw l}function me(l){let e;if(p)if(e=l.k,!e||e.p!==p)e={d:0,c:0,m:o,g:l,e:p.b,i:o,p,j:o,n:o},p.b=e,l.k=e,p.c&Y&&l.o(e);else if(e.c&E){e.c&=~E;let t=p.b,s=e.i,n=e.e;e!==t&&(s&&(s.e=n),n&&(n.i=s),t&&(t.i=e),e.i=o,e.e=t,p.b=e)}else e=o;try{return l.peek()}finally{e&&(e.d=l.d)}}function ee(l){if(l.c&=~y,l.c&B)throw l.a;return l.a}function be(l){for(let e=l.b;e;e=e.e){let t=e.g.k;t&&(e.m=t),e.g.k=e,e.c|=E}}function ye(l){let e=l.b,t;for(;e;){let s=e.e;e.c&E?(e.g.l(e),e.e=o):(t&&(t.i=e),e.i=o,e.e=t,t=e),e.g.k=e.m,e.m&&(e.m=o),e=s}l.b=t}function We(l){let e=this;ye(e),p=l,ge(),e.c&=~y}var R=class{constructor(e){let t=this;t.d=0,t.a=e,t.k=o,t.f=o}o(e){let t=this;e.c&P||(e.c|=P,e.j=t.f,t.f&&(t.f.n=e),t.f=e)}l(e){let t=this,s=e.n,n=e.j;e.c&P&&(e.c&=~P,s&&(s.j=n,e.n=o),n&&(n.n=s,e.j=o),e===t.f&&(t.f=n))}subscribe(e){let t=this;return d(function(){let s=t.value,n=p;p=o;try{return e(s)}finally{p=n}})}set(e){return this.value=e}peek(){return this.a}get value(){return me(this)}set value(e){let t=this;if(e!==t.a){if(t.a=e,te>100)return;t.d++,K++,_e();try{for(let s=t.f;s;s=s.j)s.p.q()}finally{ge()}}}},G=class extends R{constructor(e){super(o),this.r=e,this.b=o,this.c=E,this.t=K-1}o(e){let t=this;if(!t.f){t.c|=E|Y;for(let s=t.b;s;s=s.e)s.g.o(s)}super.o(e)}l(e){let t=this;if(super.l(e),!t.f){t.c&=~Y;for(let s=t.b;s;s=s.e)s.g.l(s)}}q(){let e=this;if(!(e.c&(C|y))){e.c|=E|C;for(let t=e.f;t;t=t.j)t.p.q()}}peek(){let e=this;if(e.c&=~C,e.c&y)return e.a;if(e.c|=y,!(e.c&E)&&e.f||e.t===K)return ee(e);if(e.c&=~E,e.t=K,e.d>0){let i=e.b;for(;i&&i.g.d===i.d;){try{i.g.peek()}catch{}if(i.g.d!==i.d)break;i=i.e}if(!i)return ee(e)}let t=e.a,s=e.c,n=p;try{p=e,be(e),e.a=e.r(),e.c&=~B,(s&B||e.a!==t||e.d===0)&&e.d++}catch(i){e.a=i,e.c|=B,e.d++}finally{ye(e),p=n}return ee(e)}get value(){let e=this;return e.c&y?e.a:me(e)}set value(e){super.value=e}},U=class{constructor(e){this.r=e,this.b=o,this.h=0,this.c=Y}s(){let e=this;if(e.c&y)return;let t=e.u();try{e.r()}finally{t()}}u(){let e=this,t=p;return e.c|=y,_e(),p=e,be(e),We.bind(e,t)}q(){let e=this;e.c&(C|y)||(e.c|=C,N||(N=[]),N.push(e))}v(){let e=this;for(let t=e.b;t;t=t.e)t.g.l(t);e.c|=y,e.b=o}},J=class{constructor(e){let t=this;t.scopes=[],t.cleanups=[],t.parent=o,t.h=0,!e&&_&&(t.parent=_,t.h=_.h+1,_.scopes.push(t))}run(e){let t=_;try{return _=this,e()}finally{_=t}}clear(){let e=this,t=e.scopes,s=e.cleanups;for(let n of t)n.clear(),n.parent=o;for(let n of s)n();t.length=0,s.length=0}};function I(l){return new J(l)}function ie(l){ne(l)&&_&&_.cleanups.push(l)}function w(l){return new R(l)}function z(l){return new G(l)}function d(l){let e=new U(l),t=e.v.bind(e);try{e.s()}catch(s){throw t(),s}return _&&e.b&&(e.h=_.h,_.cleanups.push(t)),t}var Ze=!1,Xe=1;var M=null,ke=ze(),F=class extends HTMLElement{$m=!1;$c=I(!0);$p={};$h=[];constructor(){super();let e=this,t=e.$p,s=e.constructor.$d;for(let n in s){let i=s[n];t[i]=w(ke)}}connectedCallback(){let e=this;if(!e.$m){e.$m=!0;let t=e.constructor.$c,s=e.constructor.$s,n=e.$c,i=e.$h,a=e.shadowRoot,h=!1;a||(a=e.attachShadow({mode:"open"}),h=!0);let v=M;try{if(M=e,n.run(()=>t(a,e)),document.adoptedStyleSheets)h&&(a.adoptedStyleSheets=s);else for(let f of s)T(a,f.cloneNode(!0));for(let f of i){let m=f();ne(m)&&n.cleanups.push(m)}i.length=0}finally{M=v}}}disconnectedCallback(){let e=this;e.$m&&(e.$c.clear(),e.shadowRoot.innerHTML="",e.$m=!1)}attributeChangedCallback(e,t,s){let n=this,i=n.constructor.$d;e in i&&(n.$p[i[e]].value=s===""?!0:s)}};function re(l,e,t,s){let n=[],i=q.create(null);class a extends F{static observedAttributes=n;static $c=e;static $a=i;static $d=t;static $s=s}for(let h in t){let v=t[h],f=de(h);i[f]=h,n.push(f),q.defineProperty(a.prototype,h,{get(){return this.$p[v].a},set(m){this.$p[v].value=m}})}return Ze&&(l="velvet-"+Xe++),l&&customElements.define(l,a),a}function Q(l,e){let t=document.createTextNode("");l.nodeType===1?T(l,t):le(l,t,!1),d(()=>t.data=e())}function V(l,e){let t=I(),s,n;d(()=>{let i=e();i!==s&&(n&&(t.clear(),Ee(l,n),n=null),s=i,i&&(n=t.run(()=>i(l))))})}function xe(l,e,t){let s=[],n=_.h+1;d(()=>{let i=t(),a=0,h=i.length,v=s.length;for(;a<h;a++)if(s[a]){let f=s[a][2];f.value=i[a]}else{let f=s[a-1],m=f?f[1]:l,x=w(i[a]),O=I(!0);O.h=n,s[a]=[O,O.run(()=>e(m,x,a)),x]}if(v>h){let f=s[a-1],m=f?f[1]:l,x=s[v-1][1];for(;a<v;a++)s[a][0].clear();Ee(m,x),s.length=h}}),ie(()=>{for(let i=0,a=s.length;i<a;i++)s[i][0].clear()})}function Ee(l,e){se(l.nextSibling,e)}var tt=S("<header class=header><h1>todos</h1><input class=new-todo placeholder='What needs to be done?'autofocus></header>"),lt=S("<section class=main><input id=toggle-all class=toggle-all type=checkbox><label for=toggle-all>Mark all as complete</label><ul class=todo-list><!></ul><footer class=footer><span class=todo-count> <strong></strong> <!> left </span><ul class=filters><li><a href=#/>All</a></li><li><a href=#/active>Active</a></li><li><a href=#/completed>Completed</a></li></ul></footer></section>"),st=S("<li><div class=view><input class=toggle type=checkbox><label><!></label><button class=destroy></button></div> <!></li>"),at=S("<input class=edit>"),nt=S("<button class=clear-completed>Clear completed</button>");function it(l,e){let n="todos",i={all:r=>r,active:r=>r.filter(c=>!c.completed),completed:r=>r.filter(c=>c.completed)},a=w(JSON.parse(localStorage.getItem(n)||"[]")),h=w("all"),v=w(null),f=w(null),m=z(()=>i[h.value](a.value)),x=z(()=>i.active(a.value).length),O=r=>{a.value=a.value.map(c=>({...c,completed:r.target.checked}))},we=()=>{a.value=a.value.filter(r=>!r.completed)},Se=r=>{r.which===13&&(a.value=a.value.concat({id:Date.now(),title:r.target.value,completed:!1}),r.target.value="")},$e=r=>{a.value=a.value.filter(c=>c.id!==r)},oe=r=>{a.value=a.value.map(c=>c.id!==r.id?c:{...c,...r})},Ae=(r,c)=>{oe({id:r,completed:c.target.checked})},Ce=r=>{r.which===13?r.target.blur():r.which===27&&(v.value=null,f.value=null)},Ne=r=>{oe({id:v.value,title:r.target.value}),v.value=null,f.value=null},ue=()=>{let r=window.location.hash.replace(/#\/?/,"");i[r]||(r="all"),h.value=r};window.addEventListener("hashchange",ue),ue(),d(()=>localStorage.setItem(n,JSON.stringify(a.value))),d(()=>{f.value&&setTimeout(()=>f.value.focus())});let W=$(tt),Re=u(W,[0,1]),Te=u(W,[0]),je=r=>{let c=$(lt),fe=u(c,[0,0]),Oe=u(c,[0,2,0]),Le=u(c,[0,3,0,1]),Ie=u(c,[0,3,0,3]),He=u(c,[0,3,1,0,0]),Pe=u(c,[0,3,1,1,0]),Be=u(c,[0,3,1,2,0]),De=u(c,[0,3,1]),Ke=u(c,[0]),Me=(Z,g)=>{let b=$(st),he=u(b,[0,0,0]),Ye=u(b,[0,0,1,0]),Ge=u(b,[0,0,1]),Ue=u(b,[0,0,2]),Je=u(b,[0,2]),H=u(b,[0]),Fe=X=>{let pe=$(at),L=u(pe,[0]);return f.value=L,d(()=>L.value=g.value.title),k(L,"keydown",Ce),k(L,"blur",Ne),j(X,pe),L};return d(()=>he.checked=g.value.completed),k(he,"change",X=>Ae(g.value.id,X)),Q(Ye,()=>g.value.title),k(Ge,"dblclick",()=>v.value=g.value.id),k(Ue,"click",()=>$e(g.value.id)),V(Je,()=>v.value===g.value.id?Fe:null),ae(H,"class","todo"),d(()=>A(H,"completed",g.value.completed)),d(()=>A(H,"editing",v.value===g.value.id)),j(Z,b),H},qe=Z=>{let g=$(nt),b=u(g,[0]);return k(b,"click",we),j(Z,g),b};return d(()=>fe.checked=x.value===0),k(fe,"change",O),xe(Oe,Me,()=>m.value),Q(Le,()=>x.value),Q(Ie,()=>x.value===1?"item":"items"),d(()=>A(He,"selected",h.value==="all")),d(()=>A(Pe,"selected",h.value==="active")),d(()=>A(Be,"selected",h.value==="completed")),V(De,()=>a.value.length>x.value?qe:null),j(r,c),Ke};k(Re,"keydown",Se),V(Te,()=>a.value.length>0?je:null),T(l,W)}var ce=re("x-app",it,{},[]);ce.prototype.attachShadow=function(){return this};var rt=new ce;document.body.append(rt);
//# sourceMappingURL=index.js.map

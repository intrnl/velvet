var H=100,ie=function(){function n(e,t,i,s){this.min=e,this.max=t,this.mean=i,this.last=s}return n}(),z=function(){function n(e){this.samples=[],this.maxSamples=e,this._i=-1}return n.prototype.addSample=function(e){this._i=(this._i+1)%this.maxSamples,this.samples[this._i]=e},n.prototype.each=function(e){for(var t=this.samples,i=0;i<t.length;i++)e(t[(this._i+1+i)%t.length],i)},n.prototype.calc=function(){var e=this.samples;if(e.length===0)return new ie(0,0,0,0);for(var t=e[(this._i+1)%e.length],i=t,s=0,r=0;r<e.length;r++){var a=e[(this._i+1+r)%e.length];a<t&&(t=a),a>i&&(i=a),s+=a}var l=e[this._i],o=s/e.length;return new ie(t,i,o,l)},n}(),ke=function(){function n(){this.value=0,this.onChange=null}return n.prototype.inc=function(e){e>0&&(this.value+=e,this.onChange())},n}(),Me=function(){function n(e,t){this.value=t,this.next=null}return n}(),$e=function(){function n(e){var t=this;this._dec=function(){for(var i=performance.now();t._firstTimestamp!==null;){var s=t._firstTimestamp;if(i>=s.value)t.value-=s.value,t._firstTimestamp=t._firstTimestamp.next;else{setTimeout(t._dec,Math.ceil(s.value-i));break}}t._firstTimestamp===null&&(t._lastTimestamp=null),t.onChange()},this.interval=e,this.value=0,this.onChange=null,this._firstTimestamp=null,this._lastTimestamp=null}return n.prototype.inc=function(e){if(e>0){var t=new Me(performance.now()+this.interval,e);this._firstTimestamp===null?(this._firstTimestamp=t,setTimeout(this._dec,this.interval)):this._lastTimestamp.next=t,this._lastTimestamp=t,this.value+=e,this.onChange()}},n}(),B=[],ae=-1;function He(n){B.push(n),ae===-1&&requestAnimationFrame(function(e){ae=-1;var t=B;B=[];for(var i=0;i<t.length;i++)t[i]()})}var re=function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),M=30,se=H,le=function(){function n(e){var t=this;this._sync=function(){t.sync(),t._dirty=!1},this.name=e,this.element=document.createElement("div"),this.element.style.cssText="padding: 2px;background-color: #020;font-family: monospace;font-size: 12px;color: #0f0",this._dirty=!1,this.invalidate()}return n.prototype.invalidate=function(){this._dirty||(this._dirty=!0,He(this._sync))},n.prototype.sync=function(){throw new Error("sync method not implemented")},n}(),d;(function(n){n[n.HideMin=1]="HideMin",n[n.HideMax=2]="HideMax",n[n.HideMean=4]="HideMean",n[n.HideLast=8]="HideLast",n[n.HideGraph=16]="HideGraph",n[n.RoundValues=32]="RoundValues"})(d||(d={}));var F=function(n){re(e,n);function e(t,i,s,r){var a=n.call(this,t)||this;a.flags=i,a.unitName=s,a.samples=r;var l=document.createElement("div");l.style.cssText="text-align: center",l.textContent=a.name;var o=document.createElement("div");return i&d.HideMin?a.minText=null:(a.minText=document.createElement("div"),o.appendChild(a.minText)),i&d.HideMax?a.maxText=null:(a.maxText=document.createElement("div"),o.appendChild(a.maxText)),i&d.HideMean?a.meanText=null:(a.meanText=document.createElement("div"),o.appendChild(a.meanText)),i&d.HideLast?a.lastText=null:(a.lastText=document.createElement("div"),o.appendChild(a.lastText)),a.element.appendChild(l),a.element.appendChild(o),i&d.HideGraph?(a.canvas=null,a.ctx=null):(a.canvas=document.createElement("canvas"),a.canvas.style.cssText="display: block; padding: 0; margin: 0",a.canvas.width=se,a.canvas.height=M,a.ctx=a.canvas.getContext("2d"),a.element.appendChild(a.canvas)),a}return e.prototype.sync=function(){var t=this,i=this.samples.calc(),s=M/(i.max*1.2),r,a,l,o;this.flags&d.RoundValues?(r=Math.round(i.min).toString(),a=Math.round(i.max).toString(),l=Math.round(i.mean).toString(),o=Math.round(i.last).toString()):(r=i.min.toFixed(2),a=i.max.toFixed(2),l=i.mean.toFixed(2),o=i.last.toFixed(2)),this.minText!==null&&(this.minText.textContent="min: \xA0"+r+this.unitName),this.maxText!==null&&(this.maxText.textContent="max: \xA0"+a+this.unitName),this.meanText!==null&&(this.meanText.textContent="mean: "+l+this.unitName),this.lastText!==null&&(this.lastText.textContent="last: "+o+this.unitName),this.ctx!==null&&(this.ctx.fillStyle="#010",this.ctx.fillRect(0,0,se,M),this.ctx.fillStyle="#0f0",this.samples.each(function(u,p){t.ctx.fillRect(p,M,1,-(u*s))}))},e}(le),Ne=function(n){re(e,n);function e(t,i){var s=n.call(this,t)||this;return s.counter=i,s.text=document.createElement("div"),s.element.appendChild(s.text),s}return e.prototype.sync=function(){this.text.textContent=this.name+": "+this.counter.value},e}(le),v=null,Ae=!1;function Q(){v||(v=document.createElement("div"),v.style.cssText="position: fixed;opacity: 0.9;right: 0;bottom: 0",document.body.appendChild(v)),Ae=!0}function oe(n){n===void 0&&(n=d.HideMin|d.HideMax|d.HideMean|d.RoundValues),Q();var e=new z(H),t=new F("FPS",n,"",e);v.appendChild(t.element);var i=2/121,s=0,r=60;function a(l){s>0&&(r+=i*(1e3/(l-s)-r)),s=l,e.addSample(r),t.invalidate(),requestAnimationFrame(a)}requestAnimationFrame(a)}function ue(n){if(n===void 0&&(n=d.HideMin|d.HideMean),Q(),performance.memory===void 0)return;var e=new z(H),t=new F("Memory",n,"MB",e);v.appendChild(t.element);function i(){e.addSample(Math.round(performance.memory.usedJSHeapSize/(1024*1024))),t.invalidate(),setTimeout(i,30)}i()}var Pe=function(){function n(e,t,i){this.data=new z(H),this.widget=new F(e,i,t,this.data),this.startTime=-1}return n}(),$={},Ye=function(){function n(e,t){var i=this;this.data=t===void 0?new ke:new $e(t),this.widget=new Ne(e,this.data),this.data.onChange=function(){i.widget.invalidate()}}return n}();function ce(n,e){e===void 0&&(e=0),Q();var t=$[n];t===void 0&&($[n]=t=new Pe(n,"ms",e),v.appendChild(t.widget.element))}function fe(n){var e=$[n];e!==void 0&&(e.startTime=performance.now())}function de(n){var e=performance.now(),t=$[n];t!==void 0&&t.startTime!==-1&&(t.data.addSample(e-t.startTime),t.widget.invalidate())}function T(n,e){let t=document.createElement("template");if(t.innerHTML=n,e){let i=t.content,s=i.firstChild,r;for(s.remove();r=s.firstChild;)i.appendChild(r)}return t}function C(n){return document.importNode(n.content,!0)}function m(n,e){let t=n,i=0,s=e.length,r,a;for(;i<s;i++)for(r=e[i],t=t.firstChild,a=0;a<r;a++)t=t.nextSibling;return t}function he(n,e,t){if(n.replaceWith(e),t){let i;for(;i=n.firstChild;)e.appendChild(i)}}function S(n,e){n.append(e)}function V(n,e){n.after(e)}function pe(n,e){let t=n;if(e.nextSibling!==n)for(;t;){let i=t;if(t=t.nextSibling,i.remove(),i===e)break}}function I(n,e,t){n.setAttribute(e,t)}var P=Object,je=Symbol,De=/\B([A-Z])/g;function me(n){return n.replace(De,"-$1").toLowerCase()}var Oe=P.is,Ve=P.assign,L=n=>typeof n=="function";var c,b=1<<0,U=1<<1,Ze=1<<2,g=1<<3,We=1<<4,ve=1<<5,h,f,N,A=0,J=0,Ie=0;function _e(){A++}function xe(){if(A>1){A--;return}let n,e=!1;for(;N;){let t=N.sort((r,a)=>r.i-a.i),i=0,s=t.length;for(N=c,J++;i<s;i++){let r=t[i];if(r.c&=~U,!(r.c&g)&&Ge(r))try{r.t()}catch(a){e||(n=a,e=!0)}}}if(J=0,A--,e)throw n}function Le(n){if(!f)return c;let e=n.k;return!e||e.q!==f?(e={d:0,n:e,g:n,h:f.b,e:c,q:f,l:c,j:c},f.b&&(f.b.e=e),f.b=e,n.k=e,f.c&ve&&n.o(e),e):e.d===-1?(e.d=0,e.e&&(e.e.h=e.h,e.h&&(e.h.e=e.e),e.h=f.b,e.e=c,f.b.e=e,f.b=e),e):c}function Ge(n){for(let e=n.b;e;e=e.e)if(e.g.d!==e.d||!e.g.p()||e.g.d!==e.d)return!0;return!1}function qe(n){for(let e=n.b;e;e=e.e){let t=e.g.k;if(t&&(e.n=t),e.g.k=e,e.d=-1,!e.e){n.b=e;break}}}function ye(n){let e=n.b,t=c;for(;e;){let i=e.h;e.d===-1?(e.g.m(e),i&&(i.e=e.e),e.e&&(e.e.h=i)):t=e,e.g.k=e.n,e.n&&(e.n=c),e=i}n.b=t}function be(n){for(let e=n.b;e;e=e.e)e.g.m(e);n.b=c}function Be(n){let e=this;ye(e),f=n,e.c&=~b,e.c&g&&be(e),xe()}var R=class{constructor(e){this.a=e,this.d=0,this.k=c,this.f=c}p(){return!0}o(e){let t=this;t.f!==e&&!e.l&&(e.j=t.f,t.f&&(t.f.l=e),t.f=e)}m(e){let t=this;if(t.f){let i=e.l,s=e.j;i&&(i.j=s,e.l=c),s&&(s.l=i,e.j=c),e===t.f&&(t.f=s)}}subscribe(e){let t=this;return _(()=>{let i=f,s=t.value;try{f=c,e(s)}finally{f=i}})}set(e){return this.value=e}peek(){return this.a}get value(){let e=this,t=Le(e);return t&&(t.d=e.d),e.a}set value(e){let t=this;if(t.a!==e&&(t.a=e,t.d++,Ie++,J<100)){_e();try{for(let i=t.f;i;i=i.j)i.q.r()}finally{xe()}}}};var j=class{constructor(e){this.s=e,this.b=c,this.c=ve,this.i=0}t(){let e=this;if(e.c&(b|g))return;let t=e.v();try{e.s()}finally{t()}}v(){let e=this;e.c|=b,e.c&=~g,ye(e),qe(e),_e();let t=f;return f=e,Be.bind(e,t)}r(){let e=this;e.c&(U|b)||(e.c|=U,(N||=[]).push(e))}w(){let e=this;e.c|=g,e.c&b||be(e)}},D=class{constructor(e){let t=this;t.scopes=[],t.cleanups=[],t.parent=c,t.i=0,!e&&h&&(t.parent=h,t.i=h.i+1,h.scopes.push(t))}run(e){let t=h;try{return h=this,e()}finally{h=t}}clear(){let e=this,t=e.scopes,i=e.cleanups;for(let s of t)s.clear(),s.parent=c;for(let s of i)s();t.length=0,i.length=0}};function K(n){return new D(n)}function ge(n){L(n)&&h&&h.cleanups.push(n)}function X(n){return new R(n)}function _(n){let e=new j(n),t=e.w.bind(e);try{e.t()}catch(i){throw t(),i}return h&&e.b&&(e.i=h.i,h.cleanups.push(t)),t}var ze=!1,Fe=1;var w=null,Y=je(),O=class extends HTMLElement{$m=!1;$c=K(!0);$p={};$h=[];constructor(){super();let e=this,t=e.$p,i=e.constructor.$d;for(let s in i){let r=i[s];t[r]=X(Y)}}connectedCallback(){let e=this;if(!e.$m){e.$m=!0;let t=e.constructor.$c,i=e.constructor.$s,s=e.$c,r=e.$h,a=e.shadowRoot,l=!1;a||(a=e.attachShadow({mode:"open"}),l=!0);let o=w;try{if(w=e,s.run(()=>t(a,e)),document.adoptedStyleSheets)l&&(a.adoptedStyleSheets=i);else for(let u of i)S(a,u.cloneNode(!0));for(let u of r){let p=u();L(p)&&s.cleanups.push(p)}r.length=0}finally{w=o}}}disconnectedCallback(){let e=this;e.$m&&(e.$c.clear(),e.shadowRoot.innerHTML="",e.$m=!1)}attributeChangedCallback(e,t,i){let s=this,r=s.constructor.$d;e in r&&(s.$p[r[e]].value=i===""?!0:i)}};function Z(n,e,t,i){let s=[],r=P.create(null);class a extends O{static observedAttributes=s;static $c=e;static $a=r;static $d=t;static $s=i}for(let l in t){let o=t[l],u=me(l);r[u]=l,s.push(u),P.defineProperty(a.prototype,l,{get(){return this.$p[o].a},set(p){this.$p[o].value=p}})}return ze&&(n="velvet-"+Fe++),n&&customElements.define(n,a),a}function W(n,e){let t=w.$p[n];return t.value===Y&&(t.value=L(e)?e():e),t}function E(n,e){let t=document.createTextNode("");n.nodeType===1?S(n,t):he(n,t,!1),_(()=>t.data=e())}function ee(n,e,t){let i=[],s=h.i+1;_(()=>{let r=t(),a=0,l=r.length,o=i.length;for(;a<l;a++)if(i[a]){let u=i[a][2];u.value=r[a]}else{let u=i[a-1],p=u?u[1]:n,x=X(r[a]),y=K(!0);y.i=s,i[a]=[y,y.run(()=>e(p,x,a)),x]}if(o>l){let u=i[a-1],p=u?u[1]:n,x=i[o-1][1];for(;a<o;a++)i[a][0].clear();Qe(p,x),i.length=l}}),ge(()=>{for(let r=0,a=i.length;r<a;r++)i[r][0].clear()})}function Qe(n,e){pe(n.nextSibling,e)}var Ue=T("<table class='table table-striped latest-data'><tbody><!></tbody></table>"),Je=T("<tr><td class=dbname><!></td><td class=query-count><span> <!> </span></td></tr>"),Ke=T("<td><!> <div class='popover left'><div class=popover-content></div><div class=arrow></div></div></td>");function Xe(n,e){let t=W(0,()=>[]),i=C(Ue),s=m(i,[0,0,0]);ee(s,(a,l)=>{let o=C(Je),u=m(o,[0,0,0]),p=m(o,[0,1,0,1]),x=m(o,[0,1,0]),y=m(o,[0,1]),we=m(o,[0]),Te=(Ce,q)=>{let k=C(Ke),Se=m(k,[0,0]),Ee=m(k,[0,2,0]),ne=m(k,[0]);return E(Se,()=>q.value.formatElapsed),E(Ee,()=>q.value.query),_(()=>I(ne,"class",`Query ${q.value.elapsedClassName}`)),V(Ce,k),ne};return E(u,()=>l.value.dbname),E(p,()=>l.value.lastSample.nbQueries),_(()=>I(x,"class",l.value.lastSample.countClassName)),ee(y,Te,()=>l.value.lastSample.topFiveQueries),V(a,o),we},()=>t.value),S(n,i)}var te=Z("x-app",Xe,{dbs:0},[]);te.prototype.attachShadow=function(){return this};var G=new te;G.dbs=ENV.generateData().toArray();document.body.appendChild(G);if(/[&?]perfmon=(false|off|0)\b/.test(location.search)){let n=function(){let e=ENV.generateData().toArray();G.dbs=e,setTimeout(n,ENV.timeout)};n()}else{let n=function(){let e=ENV.generateData().toArray();fe("view update"),G.dbs=e,de("view update"),setTimeout(n,ENV.timeout)};oe(),ue(),ce("view update"),n()}
//# sourceMappingURL=index.js.map

var Me=Object,Ze=Symbol,Qe=/\B([A-Z])/g;function Ee(n){return n.replace(Qe,"-$1").toLowerCase()}var Y=n=>typeof n=="function";var B,S=1,$=2,k=4,pe=8,G=16,q=32,et=(n,e)=>n.e-e.e,p,f,x,h=0,W,K=0,me=0,L=0,tt=0;function Ae(){K++}function Re(){if(K>1){K--;return}let n,e=!1;for(;W;){let t=W.sort(et),i=0,l=t.length;for(W=B,me++;i<l;i++){let s=t[i];if(s.a&=~$,!(s.a&pe)&&He(s))try{s.f()}catch(a){e||(n=a,e=!0)}}}if(me=0,K--,e)throw n}function He(n){let e=n.b,t=e.length,i=0,l;for(;i<t;i++)if(l=e[i],l.d>n.d||l.f())return!0;return!1}function ke(){let n=f.b;if(x){if(Ce(),h>0){let i=x.length,l=0;for(n.length=h+i;l<i;l++)n[h+l]=x[l]}else n=f.b=x;let e=n.length,t=h;for(;t<e;t++){let i=n[t];f.a&q&&i.k(f)}}else h<f.b.length&&(Ce(),n.length=h)}function Ce(){let n=f.b,e=n.length,t=h;for(;t<e;t++)n[t].i(f)}function Pe(n){let e=n.b,t=e.length,i=0;for(;i<t;i++)e[i].i(n);e.length=0}var O=class{d=-1;g=-1;h=[];c;constructor(e){let t=this;t.c=e}f(){return!1}k(e){this.h.push(e)}i(e){let i=this.h,l=i.indexOf(e);i.splice(l,1)}peek(){return this.c}get value(){let e=this;return f&&f.g!==e.g&&(e.g=f.g,x?x.push(e):f.b[h]===e?h++:x=[e]),e.c}set value(e){let t=this;if(t.c!==e&&(t.c=e,t.d=++L,me<100)){let i=t.h,l=i.length,s=0;for(Ae();s<l;s++)i[s].l();Re()}}},J=class extends O{b=[];a=k;m=-1;j;constructor(e){super();let t=this;t.j=e}f(){let e=this,t=e.a&=~$;if(t&S||(t&q?!(t&k):e.m===L))return!1;if(e.a=t&~k|S,e.m=L,e.d>-1&&!He(e))return e.a&=~S,!1;let i=!1,l=f,s=x,a=h,o;try{f=e,x=B,h=0,o=e.j(),(t&G||e.c!==o||e.d===-1)&&(i=!0,e.c=o,e.a&=~G,e.d=++L)}catch(r){i=!0,e.c=r,e.a|=G,e.d=++L}return ke(),f=l,x=s,h=a,e.a&=~S,i}k(e){let t=this;if(t.h.length<1){let i=t.b,l=i.length,s=0;for(t.a|=q;s<l;s++)i[s].k(t)}super.k(e)}i(e){let t=this;if(super.i(e),t.h.length<1){let i=t.b,l=i.length,s=0;for(t.a&=~q;s<l;s++)i[s].i(t)}}l(){let e=this;if(!(e.a&($|S))){let t=e.h,i=t.length,l=0;for(e.a|=k|$;l<i;l++)t[l].l()}}peek(){let e=this;if(e.f(),e.a&G)throw e.c;return e.c}get value(){let e=this;if(e.f(),e.a&G)throw super.value;return super.value}set value(e){super.value=e}},Z=class{d=0;g=0;b=[];a=q;e=0;j;constructor(e){let t=this;t.j=e}f(){let e=this,t=e.a;if(t&S)return;e.d=L,e.g=tt++,e.a=t&~k|S;let i=f,l=x,s=h;try{Ae(),f=e,x=B,h=0,e.j()}finally{ke(),f=i,x=l,h=s,e.a&=~S,e.a&pe&&Pe(e),Re()}}l(){let e=this;e.a&($|S)||(e.a|=k|$,(W||=[]).push(e))}n(){let e=this;e.a|=pe,e.a&S||Pe(e)}},z=class{constructor(e){let t=this;t.scopes=[],t.cleanups=[],t.parent=B,t.e=0,!e&&p&&(t.parent=p,t.e=p.e+1,p.scopes.push(t))}run(e){let t=p;try{return p=this,e()}finally{p=t}}clear(){let e=this,t=e.scopes,i=e.cleanups;for(let l of t)l.clear(),l.parent=B;for(let l of i)l();t.length=0,i.length=0}};function F(n){return new z(n)}function ee(n){Y(n)&&p&&p.cleanups.push(n)}function T(n){return new O(n)}function E(n){return new J(n)}function y(n){let e=new Z(n),t=e.n.bind(e);try{e.f()}catch(i){throw t(),i}return p&&e.b.length>0&&(e.e=p.e,p.cleanups.push(t)),t}var nt=!1,it=1;var I=null,ve=Ze(),Q=class extends HTMLElement{$m=!1;$c=F(!0);$p={};$h=[];constructor(){super();let e=this,t=e.$p,i=e.constructor.$d;for(let l in i){let s=i[l];t[s]=T(ve)}}connectedCallback(){let e=this;if(!e.$m){e.$m=!0;let t=e.constructor.$c,i=e.constructor.$s,l=e.$c,s=e.$h,a=e.shadowRoot;a||(a=e.attachShadow({mode:"open"}),a.adoptedStyleSheets=i);let o=I;try{I=e,l.run(()=>t(a,e));for(let r=0,d=s.length;r<d;r++){let u=s[r],c=u();Y(c)&&l.cleanups.push(c)}s.length=0}finally{I=o}}}disconnectedCallback(){let e=this;e.$m&&(e.$c.clear(),e.shadowRoot.innerHTML="",e.$m=!1)}attributeChangedCallback(e,t,i){let l=this,s=l.constructor.$d;e in s&&(l.$p[s[e]].value=i===""?!0:i)}};function U(n,e,t,i){let l=[],s=Me.create(null);class a extends Q{static observedAttributes=l;static $c=e;static $a=s;static $d=t;static $s=i}for(let o in t){let r=t[o],d=Ee(o);s[d]=o,l.push(d),Me.defineProperty(a.prototype,o,{get(){return this.$p[r].c},set(u){this.$p[r].value=u}})}return nt&&(n="velvet-"+it++),n&&customElements.define(n,a),a}function _e(n,e){let t=I.$p[n];return t.value===ve&&(t.value=Y(e)?e():e),t}function te(n){Y(n)&&I.$h.push(n)}function N(n,e){let t=document.createElement("template");if(t.innerHTML=n,e){let i=t.content,l=i.firstChild,s;for(l.remove();s=l.firstChild;)i.appendChild(s)}return t}function D(n){return document.importNode(n.content,!0)}function b(n){return n.firstChild}function A(n){return n.nextSibling}function xe(n,e,t){if(n.replaceWith(e),t){let i;for(;i=n.firstChild;)e.appendChild(i)}}function j(n,e){n.append(e)}function ge(n,e){n.after(e)}function Le(n,e){let t=n;if(e.nextSibling!==n)for(;t;){let i=t;if(t=t.nextSibling,i.remove(),i===e)break}}function be(n,e,t,i){n.addEventListener(e,t,i)}function ne(n,e,t){n.setAttribute(e,t)}function Ie(n,e,t){let i=document.createTextNode("");t(n,i),y(()=>i.data=e())}function Oe(n,e,t,i){let l=[],s=p.a+1,a=null;y(()=>{let o=t(),r=0,d=o.length,u=l.length;if(i&&a&&d>0){let c=a[0],M=a[1];c.clear(),$e(n,M),a=null}for(;r<d;r++)if(l[r]){let c=l[r][2];c.value=o[r]}else{let c=l[r-1],M=c?c[1]:n,R=T(o[r]),C=F(!0);C.a=s,l[r]=[C,C.run(()=>e(M,R,r)),R]}if(u>d){let c=l[r-1],M=c?c[1]:n,R=l[u-1][1];for(;r<u;r++)l[r][0].clear();$e(M,R),l.length=d}if(i&&!a&&d<1){let c=F(!0);c.a=s,a=[c,c.run(()=>i(n))]}}),ee(()=>{for(let o=0,r=l.length;o<r;o++)l[o][0].clear()})}function $e(n,e){Le(n.nextSibling,e)}function dt(n){for(var e=n.length/6|0,t=new Array(e),i=0;i<e;)t[i]="#"+n.slice(i*6,++i*6);return t}function ht(n){let e=n.length;return t=>n[Math.max(0,Math.min(e-1,Math.floor(t*e)))]}var Ne=ht(dt("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725"));var pt=N("<svg class=demo><!></svg>"),mt=N("<svg><rect class=point>",!0),g={PHYLLOTAXIS:0,GRID:1,WAVE:2,SPIRAL:3},ie=[g.PHYLLOTAXIS,g.SPIRAL,g.PHYLLOTAXIS,g.GRID,g.WAVE],vt=Math.PI*(3-Math.sqrt(5));function De(n){switch(n){case g.PHYLLOTAXIS:return"px";case g.GRID:return"gx";case g.WAVE:return"wx";case g.SPIRAL:return"sx"}}function je(n){switch(n){case g.PHYLLOTAXIS:return"py";case g.GRID:return"gy";case g.WAVE:return"wy";case g.SPIRAL:return"sy"}}function Ve(n,e,t,i){let l=n[t];return l+(n[i]-l)*e}function _t(n){return e=>{let t=Math.sqrt(e/n),i=e*vt;return[t*Math.cos(i),t*Math.sin(i)]}}function xt(n){let e=Math.round(Math.sqrt(n));return t=>[-.8+1.6/e*(t%e),-.8+1.6/e*Math.floor(t/e)]}function gt(n){let e=2/(n-1);return t=>{let i=-1+t*e;return[i,Math.sin(i*Math.PI*3)*.3]}}function bt(n){return e=>{let t=Math.sqrt(e/(n-1)),i=t*Math.PI*10;return[t*Math.cos(i),t*Math.sin(i)]}}function yt(n,e){return e.map(t=>t*n)}function wt(n,e){return e.map((t,i)=>t+n[i])}function le(n){let e=window.innerHeight/2,t=window.innerWidth/2;return wt([t,e],yt(Math.min(e,t),n))}function St(n,e){let t=_e(0,1e3),i=60*2,l=T(!1),s=T(0),a=T(0),o=E(()=>_t(t.value)),r=E(()=>bt(t.value)),d=E(()=>xt(t.value)),u=E(()=>gt(t.value)),c=E(()=>R(t.value));te(()=>(requestAnimationFrame(M),()=>{l.value=!0}));function M(){if(l.value)return;let v=(s.value+1)%i,w=v===0?(a.value+1)%ie.length:a.value;a.value=w,s.value=v;let _=Math.min(1,v/(i*.8)),P=ie[w],X=ie[(w+1)%ie.length],ce=De(P),ue=De(X),fe=je(P),de=je(X);c.value=c.value.map(he=>{let H={...he};return H.x=Ve(H,_,ce,ue),H.y=Ve(H,_,fe,de),H}),requestAnimationFrame(M)}function R(v){let w=[];for(let _=0;_<v;_++){let[P,X]=le((0,o.value)(_)),[ce,ue]=le((0,r.value)(_)),[fe,de]=le((0,d.value)(_)),[he,H]=le((0,u.value)(_));w.push({x:0,y:0,color:Ne(_/v),px:P,py:X,sx:ce,sy:ue,gx:fe,gy:de,wx:he,wy:H})}return w}let C=D(pt);Oe(b(b(C)),(v,w)=>{let _=D(mt),P=b(_);return y(()=>ne(P,"transform",`translate(${Math.floor(w.value.x)}, ${Math.floor(w.value.y)})`)),y(()=>ne(P,"fill",w.value.color)),ge(v,_),P},()=>c.value),j(n,C)}var ae=U("x-viz-demo",St,{count:0},[]);var Tt=N("<div class=app-wrapper><x></x><div class=controls><span># Points</span><input type=range min=10 max=10000><span></span></div><span class=about> Velvet 1k Points demo, based on the <a href=https://dingoeatingfuzz.github.io/glimmer-1k/ target=_blank>Glimmer demo by Michael Lange</a> </span></div>");function Mt(n,e){let t=T(1e3);y(()=>{let oe=new URLSearchParams(location.search);if(oe.has("count")){let v=parseInt(oe.get("count"));!Number.isNaN(v)&&v>=10&&v<=1e4&&(t.value=v)}});let i=D(Tt),s=b(b(i)),a=new ae,o=A(s),r=b(o),d=b(r),u=A(r),c=A(u),C=A(b(A(o))),Ke=b(C),Je=A(C);y(()=>a.count=t.value),xe(s,s=a,!0),y(()=>u.value=t.value),be(u,"input",()=>t.value=u.value),Ie(c,()=>t.value,j),j(n,i)}var ye=U("x-app",Mt,{},[]);var re=100,Ge=function(){function n(e,t,i,l){this.min=e,this.max=t,this.mean=i,this.last=l}return n}(),Se=function(){function n(e){this.samples=[],this.maxSamples=e,this._i=-1}return n.prototype.addSample=function(e){this._i=(this._i+1)%this.maxSamples,this.samples[this._i]=e},n.prototype.each=function(e){for(var t=this.samples,i=0;i<t.length;i++)e(t[(this._i+1+i)%t.length],i)},n.prototype.calc=function(){var e=this.samples;if(e.length===0)return new Ge(0,0,0,0);for(var t=e[(this._i+1)%e.length],i=t,l=0,s=0;s<e.length;s++){var a=e[(this._i+1+s)%e.length];a<t&&(t=a),a>i&&(i=a),l+=a}var o=e[this._i],r=l/e.length;return new Ge(t,i,r,o)},n}(),Ct=function(){function n(){this.value=0,this.onChange=null}return n.prototype.inc=function(e){e>0&&(this.value+=e,this.onChange())},n}(),Pt=function(){function n(e,t){this.value=t,this.next=null}return n}(),Et=function(){function n(e){var t=this;this._dec=function(){for(var i=performance.now();t._firstTimestamp!==null;){var l=t._firstTimestamp;if(i>=l.value)t.value-=l.value,t._firstTimestamp=t._firstTimestamp.next;else{setTimeout(t._dec,Math.ceil(l.value-i));break}}t._firstTimestamp===null&&(t._lastTimestamp=null),t.onChange()},this.interval=e,this.value=0,this.onChange=null,this._firstTimestamp=null,this._lastTimestamp=null}return n.prototype.inc=function(e){if(e>0){var t=new Pt(performance.now()+this.interval,e);this._firstTimestamp===null?(this._firstTimestamp=t,setTimeout(this._dec,this.interval)):this._lastTimestamp.next=t,this._lastTimestamp=t,this.value+=e,this.onChange()}},n}(),we=[],qe=-1;function At(n){we.push(n),qe===-1&&requestAnimationFrame(function(e){qe=-1;var t=we;we=[];for(var i=0;i<t.length;i++)t[i]()})}var ze=function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}(),se=30,Be=re,Ye=function(){function n(e){var t=this;this._sync=function(){t.sync(),t._dirty=!1},this.name=e,this.element=document.createElement("div"),this.element.style.cssText="padding: 2px;background-color: #020;font-family: monospace;font-size: 12px;color: #0f0",this._dirty=!1,this.invalidate()}return n.prototype.invalidate=function(){this._dirty||(this._dirty=!0,At(this._sync))},n.prototype.sync=function(){throw new Error("sync method not implemented")},n}(),m;(function(n){n[n.HideMin=1]="HideMin",n[n.HideMax=2]="HideMax",n[n.HideMean=4]="HideMean",n[n.HideLast=8]="HideLast",n[n.HideGraph=16]="HideGraph",n[n.RoundValues=32]="RoundValues"})(m||(m={}));var Te=function(n){ze(e,n);function e(t,i,l,s){var a=n.call(this,t)||this;a.flags=i,a.unitName=l,a.samples=s;var o=document.createElement("div");o.style.cssText="text-align: center",o.textContent=a.name;var r=document.createElement("div");return i&m.HideMin?a.minText=null:(a.minText=document.createElement("div"),r.appendChild(a.minText)),i&m.HideMax?a.maxText=null:(a.maxText=document.createElement("div"),r.appendChild(a.maxText)),i&m.HideMean?a.meanText=null:(a.meanText=document.createElement("div"),r.appendChild(a.meanText)),i&m.HideLast?a.lastText=null:(a.lastText=document.createElement("div"),r.appendChild(a.lastText)),a.element.appendChild(o),a.element.appendChild(r),i&m.HideGraph?(a.canvas=null,a.ctx=null):(a.canvas=document.createElement("canvas"),a.canvas.style.cssText="display: block; padding: 0; margin: 0",a.canvas.width=Be,a.canvas.height=se,a.ctx=a.canvas.getContext("2d"),a.element.appendChild(a.canvas)),a}return e.prototype.sync=function(){var t=this,i=this.samples.calc(),l=se/(i.max*1.2),s,a,o,r;this.flags&m.RoundValues?(s=Math.round(i.min).toString(),a=Math.round(i.max).toString(),o=Math.round(i.mean).toString(),r=Math.round(i.last).toString()):(s=i.min.toFixed(2),a=i.max.toFixed(2),o=i.mean.toFixed(2),r=i.last.toFixed(2)),this.minText!==null&&(this.minText.textContent="min: \xA0"+s+this.unitName),this.maxText!==null&&(this.maxText.textContent="max: \xA0"+a+this.unitName),this.meanText!==null&&(this.meanText.textContent="mean: "+o+this.unitName),this.lastText!==null&&(this.lastText.textContent="last: "+r+this.unitName),this.ctx!==null&&(this.ctx.fillStyle="#010",this.ctx.fillRect(0,0,Be,se),this.ctx.fillStyle="#0f0",this.samples.each(function(d,u){t.ctx.fillRect(u,se,1,-(d*l))}))},e}(Ye),Rt=function(n){ze(e,n);function e(t,i){var l=n.call(this,t)||this;return l.counter=i,l.text=document.createElement("div"),l.element.appendChild(l.text),l}return e.prototype.sync=function(){this.text.textContent=this.name+": "+this.counter.value},e}(Ye),V=null,Ht=!1;function Fe(){V||(V=document.createElement("div"),V.style.cssText="position: fixed;opacity: 0.9;right: 0;bottom: 0",document.body.appendChild(V)),Ht=!0}function Ue(n){n===void 0&&(n=m.HideMin|m.HideMax|m.HideMean|m.RoundValues),Fe();var e=new Se(re),t=new Te("FPS",n,"",e);V.appendChild(t.element);var i=2/121,l=0,s=60;function a(o){l>0&&(s+=i*(1e3/(o-l)-s)),l=o,e.addSample(s),t.invalidate(),requestAnimationFrame(a)}requestAnimationFrame(a)}function Xe(n){if(n===void 0&&(n=m.HideMin|m.HideMean),Fe(),performance.memory===void 0)return;var e=new Se(re),t=new Te("Memory",n,"MB",e);V.appendChild(t.element);function i(){e.addSample(Math.round(performance.memory.usedJSHeapSize/(1024*1024))),t.invalidate(),setTimeout(i,30)}i()}var fn=function(){function n(e,t,i){this.data=new Se(re),this.widget=new Te(e,i,t,this.data),this.startTime=-1}return n}();var dn=function(){function n(e,t){var i=this;this.data=t===void 0?new Ct:new Et(t),this.widget=new Rt(e,this.data),this.data.onChange=function(){i.widget.invalidate()}}return n}();We(ye);We(ae);/[&?]perfmon=(false|off|0)\b/.test(location.search)||(Ue(),Xe());var Lt=new ye;document.body.appendChild(Lt);function We(n){n.prototype.attachShadow=function(){return this.shadowRoot||Object.defineProperty(this,"shadowRoot",{value:this}),this}}
//# sourceMappingURL=index.js.map

var W=Object,Ke=Symbol,Ze=/\B([A-Z])/g;function ke(n){return n.replace(Ze,"-$1").toLowerCase()}var Qe=W.is,et=W.assign,Y=n=>typeof n=="function";var P,T=1,$=2,H=4,me=8,q=16,L=32,tt=(n,e)=>n.c-e.c,h,f,_,u=0,U,X=0,ve=0,R=0;function He(){X++}function Le(){if(X>1){X--;return}let n,e=!1;for(;U;){let t=U.sort(tt),a=0,l=t.length;for(U=P,ve++;a<l;a++){let s=t[a];if(s.d&=~$,!(s.d&me)&&Re(s))try{s.m()}catch(i){e||(n=i,e=!0)}}}if(ve=0,X--,e)throw n}function Re(n){let e=n.b,t=e.length,a=0,l;for(;a<t;a++)if(l=e[a],l.e>n.e||l.h())return!0;return!1}function $e(){let n=f.b;if(_){if(Ae(),u>0){let a=_.length,l=0;for(n.length=u+a;l<a;l++)n[u+l]=_[l]}else n=f.b=_;let e=n.length,t=u;for(;t<e;t++){let a=n[t];a.i=P,f.d&L&&a.j(f)}}else u<f.b.length&&(Ae(),n.length=u);for(;u--;){let e=n[u];e.i=P}}function Ae(){let n=f.b,e=n.length,t=u;for(;t<e;t++)n[t].g(f)}function Ee(n){let e=n.b,t=e.length,a=0;for(;a<t;a++)e[a].g(n);e.length=0}var O=class{constructor(e){let t=this;t.a=e,t.e=-1,t.f=[],t.i=P}h(){return!1}j(e){this.f.push(e)}g(e){let a=this.f,l=a.indexOf(e);a.splice(l,1)}peek(){return this.a}get value(){let e=this;return f&&e.i!==f&&(e.i=f,_?_.push(e):f.b[u]===e?u++:_=[e]),e.a}set value(e){let t=this;if(t.a!==e&&(t.a=e,t.e=++R,ve<100)){let a=t.f,l=a.length,s=0;for(He();s<l;s++)a[s].k();Le()}}},J=class extends O{constructor(e){super();let t=this;t.l=e,t.b=[],t.d=H,t.n=-1}h(){let e=this;if(e.d&=~$,e.d&T||(e.d&(H|L))===L||(e.d&=~H,e.n===R))return!1;if(e.n=R,e.d|=T,e.e>-1&&!Re(e))return e.d&=~T,!1;let t=!1,a=f,l=_,s=u;try{f=e,_=P,u=0;let i=e.l();(e.d&q||e.a!==i||e.e===-1)&&(t=!0,e.a=i,e.d&=~q,e.e=++R)}catch(i){t=!0,e.a=i,e.d|=q,e.e=++R}return $e(),f=a,_=l,u=s,e.d&=~T,t}j(e){let t=this;if(t.f.length<1){let a=t.b,l=a.length,s=0;for(t.d|=L;s<l;s++)a[s].j(t)}super.j(e)}g(e){let t=this;if(super.g(e),t.f.length<1){let a=t.b,l=a.length,s=0;for(t.d&=~L;s<l;s++)a[s].g(t)}}k(){let e=this;if(!(e.d&($|T))){let t=e.f,a=t.length,l=0;for(e.d|=H|$;l<a;l++)t[l].k()}}peek(){let e=this;if(e.h(),e.d&q)throw e.a;return e.a}get value(){let e=this;if(e.h(),e.d&q)throw super.value;return super.value}set value(e){super.value=e}},K=class{constructor(e){let t=this;t.l=e,t.e=0,t.b=[],t.d=L,t.c=0}m(){let e=this;if(e.d&T)return;e.e=R,e.d|=T,e.d&=~H;let t=f,a=_,l=u;try{He(),f=e,_=P,u=0,e.l()}finally{$e(),f=t,_=a,u=l,e.d&=~T,e.d&me&&Ee(e),Le()}}k(){let e=this;e.d&($|T)||(e.d|=H|$,(U||=[]).push(e))}o(){let e=this;e.d|=me,e.d&T||Ee(e)}},z=class{constructor(e){let t=this;t.scopes=[],t.cleanups=[],t.parent=P,t.c=0,!e&&h&&(t.parent=h,t.c=h.c+1,h.scopes.push(t))}run(e){let t=h;try{return h=this,e()}finally{h=t}}clear(){let e=this,t=e.scopes,a=e.cleanups;for(let l of t)l.clear(),l.parent=P;for(let l of a)l();t.length=0,a.length=0}};function Q(n){return new z(n)}function ee(n){Y(n)&&h&&h.cleanups.push(n)}function S(n){return new O(n)}function A(n){return new J(n)}function g(n){let e=new K(n),t=e.o.bind(e);try{e.m()}catch(a){throw t(),a}return h&&e.b.length>0&&(e.c=h.c,h.cleanups.push(t)),t}var nt=!1,at=1;var I=null,_e=Ke(),Z=class extends HTMLElement{$m=!1;$c=Q(!0);$p={};$h=[];constructor(){super();let e=this,t=e.$p,a=e.constructor.$d;for(let l in a){let s=a[l];t[s]=S(_e)}}connectedCallback(){let e=this;if(!e.$m){e.$m=!0;let t=e.constructor.$c,a=e.constructor.$s,l=e.$c,s=e.$h,i=e.shadowRoot;i||(i=e.attachShadow({mode:"open"}),i.adoptedStyleSheets=a);let r=I;try{I=e,l.run(()=>t(i,e));for(let o of s){let c=o();Y(c)&&l.cleanups.push(c)}s.length=0}finally{I=r}}}disconnectedCallback(){let e=this;e.$m&&(e.$c.clear(),e.shadowRoot.innerHTML="",e.$m=!1)}attributeChangedCallback(e,t,a){let l=this,s=l.constructor.$d;e in s&&(l.$p[s[e]].value=a===""?!0:a)}};function F(n,e,t,a){let l=[],s=W.create(null);class i extends Z{static observedAttributes=l;static $c=e;static $a=s;static $d=t;static $s=a}for(let r in t){let o=t[r],c=ke(r);s[c]=r,l.push(c),W.defineProperty(i.prototype,r,{get(){return this.$p[o].a},set(d){this.$p[o].value=d}})}return nt&&(n="velvet-"+at++),n&&customElements.define(n,i),i}function xe(n,e){let t=I.$p[n];return t.value===_e&&(t.value=Y(e)?e():e),t}function te(n){Y(n)&&I.$h.push(n)}function N(n,e){let t=document.createElement("template");if(t.innerHTML=n,e){let a=t.content,l=a.firstChild,s;for(l.remove();s=l.firstChild;)a.appendChild(s)}return t}function D(n){return document.importNode(n.content,!0)}function b(n){return n.firstChild}function E(n){return n.nextSibling}function be(n,e,t){if(n.replaceWith(e),t){let a;for(;a=n.firstChild;)e.appendChild(a)}}function V(n,e){n.append(e)}function ge(n,e){n.after(e)}function Ie(n,e){let t=n;if(e.nextSibling!==n)for(;t;){let a=t;if(t=t.nextSibling,a.remove(),a===e)break}}function ye(n,e,t,a){n.addEventListener(e,t,a)}function ne(n,e,t){n.setAttribute(e,t)}function Oe(n,e,t){let a=document.createTextNode("");t(n,a),g(()=>a.data=e())}function Ne(n,e,t){let a=[],l=h.c+1;g(()=>{let s=t(),i=0,r=s.length,o=a.length;for(;i<r;i++)if(a[i]){let c=a[i][2];c.value=s[i]}else{let c=a[i-1],d=c?c[1]:n,y=S(s[i]),M=Q(!0);M.c=l,a[i]=[M,M.run(()=>e(d,y,i)),y]}if(o>r){let c=a[i-1],d=c?c[1]:n,y=a[o-1][1];for(;i<o;i++)a[i][0].clear();dt(d,y),a.length=r}}),ee(()=>{for(let s=0,i=a.length;s<i;s++)a[s][0].clear()})}function dt(n,e){Ie(n.nextSibling,e)}function ht(n){for(var e=n.length/6|0,t=new Array(e),a=0;a<e;)t[a]="#"+n.slice(a*6,++a*6);return t}function pt(n){let e=n.length;return t=>n[Math.max(0,Math.min(e-1,Math.floor(t*e)))]}var De=pt(ht("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725"));var mt=N("<svg class=demo><!></svg>"),vt=N("<svg><rect class=point>",!0),x={PHYLLOTAXIS:0,GRID:1,WAVE:2,SPIRAL:3},ae=[x.PHYLLOTAXIS,x.SPIRAL,x.PHYLLOTAXIS,x.GRID,x.WAVE],_t=Math.PI*(3-Math.sqrt(5));function Ve(n){switch(n){case x.PHYLLOTAXIS:return"px";case x.GRID:return"gx";case x.WAVE:return"wx";case x.SPIRAL:return"sx"}}function je(n){switch(n){case x.PHYLLOTAXIS:return"py";case x.GRID:return"gy";case x.WAVE:return"wy";case x.SPIRAL:return"sy"}}function Ge(n,e,t,a){let l=n[t];return l+(n[a]-l)*e}function xt(n){return e=>{let t=Math.sqrt(e/n),a=e*_t;return[t*Math.cos(a),t*Math.sin(a)]}}function bt(n){let e=Math.round(Math.sqrt(n));return t=>[-.8+1.6/e*(t%e),-.8+1.6/e*Math.floor(t/e)]}function gt(n){let e=2/(n-1);return t=>{let a=-1+t*e;return[a,Math.sin(a*Math.PI*3)*.3]}}function yt(n){return e=>{let t=Math.sqrt(e/(n-1)),a=t*Math.PI*10;return[t*Math.cos(a),t*Math.sin(a)]}}function wt(n,e){return e.map(t=>t*n)}function Tt(n,e){return e.map((t,a)=>t+n[a])}function ie(n){let e=window.innerHeight/2,t=window.innerWidth/2;return Tt([t,e],wt(Math.min(e,t),n))}function St(n,e){let t=xe(0,1e3),a=60*2,l=S(!1),s=S(0),i=S(0),r=A(()=>xt(t.value)),o=A(()=>yt(t.value)),c=A(()=>bt(t.value)),d=A(()=>gt(t.value)),y=A(()=>oe(t.value));te(()=>(requestAnimationFrame(M),()=>{l.value=!0}));function M(){if(l.value)return;let m=(s.value+1)%a,w=m===0?(i.value+1)%ae.length:i.value;i.value=w,s.value=m;let v=Math.min(1,m/(a*.8)),C=ae[w],B=ae[(w+1)%ae.length],ue=Ve(C),fe=Ve(B),de=je(C),he=je(B);y.value=y.value.map(pe=>{let k={...pe};return k.x=Ge(k,v,ue,fe),k.y=Ge(k,v,de,he),k}),requestAnimationFrame(M)}function oe(m){let w=[];for(let v=0;v<m;v++){let[C,B]=ie((0,r.value)(v)),[ue,fe]=ie((0,o.value)(v)),[de,he]=ie((0,c.value)(v)),[pe,k]=ie((0,d.value)(v));w.push({x:0,y:0,color:De(v/m),px:C,py:B,sx:ue,sy:fe,gx:de,gy:he,wx:pe,wy:k})}return w}let G=D(mt),Ce=b(G),Pe=b(Ce);Ne(Pe,(m,w)=>{let v=D(vt),C=b(v);return g(()=>ne(C,"transform",`translate(${Math.floor(w.value.x)}, ${Math.floor(w.value.y)})`)),g(()=>ne(C,"fill",w.value.color)),ge(m,v),C},()=>y.value),V(n,G)}var le=F("x-viz-demo",St,{count:0},[]);var Mt=N("<div class=app-wrapper><x></x><div class=controls><span># Points</span><input type=range min=10 max=10000><span></span></div><span class=about> Velvet 1k Points demo, based on the <a href=https://dingoeatingfuzz.github.io/glimmer-1k/ target=_blank>Glimmer demo by Michael Lange</a> </span></div>");function Ct(n,e){let t=S(1e3);g(()=>{let ce=new URLSearchParams(location.search);if(ce.has("count")){let m=parseInt(ce.get("count"));!Number.isNaN(m)&&m>=10&&m<=1e4&&(t.value=m)}});let a=D(Mt),l=b(a),s=b(l),i=new le,r=E(s),o=b(r),c=b(o),d=E(o),y=E(d),M=E(r),oe=b(M),G=E(oe),Ce=b(G),Pe=E(G);g(()=>i.count=t.value),be(s,s=i,!0),g(()=>d.value=t.value),ye(d,"input",()=>t.value=d.value),Oe(y,()=>t.value,V),V(n,a)}var we=F("x-app",Ct,{},[]);var re=100,qe=function(){function n(e,t,a,l){this.min=e,this.max=t,this.mean=a,this.last=l}return n}(),Se=function(){function n(e){this.samples=[],this.maxSamples=e,this._i=-1}return n.prototype.addSample=function(e){this._i=(this._i+1)%this.maxSamples,this.samples[this._i]=e},n.prototype.each=function(e){for(var t=this.samples,a=0;a<t.length;a++)e(t[(this._i+1+a)%t.length],a)},n.prototype.calc=function(){var e=this.samples;if(e.length===0)return new qe(0,0,0,0);for(var t=e[(this._i+1)%e.length],a=t,l=0,s=0;s<e.length;s++){var i=e[(this._i+1+s)%e.length];i<t&&(t=i),i>a&&(a=i),l+=i}var r=e[this._i],o=l/e.length;return new qe(t,a,o,r)},n}(),Pt=function(){function n(){this.value=0,this.onChange=null}return n.prototype.inc=function(e){e>0&&(this.value+=e,this.onChange())},n}(),At=function(){function n(e,t){this.value=t,this.next=null}return n}(),Et=function(){function n(e){var t=this;this._dec=function(){for(var a=performance.now();t._firstTimestamp!==null;){var l=t._firstTimestamp;if(a>=l.value)t.value-=l.value,t._firstTimestamp=t._firstTimestamp.next;else{setTimeout(t._dec,Math.ceil(l.value-a));break}}t._firstTimestamp===null&&(t._lastTimestamp=null),t.onChange()},this.interval=e,this.value=0,this.onChange=null,this._firstTimestamp=null,this._lastTimestamp=null}return n.prototype.inc=function(e){if(e>0){var t=new At(performance.now()+this.interval,e);this._firstTimestamp===null?(this._firstTimestamp=t,setTimeout(this._dec,this.interval)):this._lastTimestamp.next=t,this._lastTimestamp=t,this.value+=e,this.onChange()}},n}(),Te=[],ze=-1;function kt(n){Te.push(n),ze===-1&&requestAnimationFrame(function(e){ze=-1;var t=Te;Te=[];for(var a=0;a<t.length;a++)t[a]()})}var Fe=function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])};return function(e,t){n(e,t);function a(){this.constructor=e}e.prototype=t===null?Object.create(t):(a.prototype=t.prototype,new a)}}(),se=30,Ye=re,Be=function(){function n(e){var t=this;this._sync=function(){t.sync(),t._dirty=!1},this.name=e,this.element=document.createElement("div"),this.element.style.cssText="padding: 2px;background-color: #020;font-family: monospace;font-size: 12px;color: #0f0",this._dirty=!1,this.invalidate()}return n.prototype.invalidate=function(){this._dirty||(this._dirty=!0,kt(this._sync))},n.prototype.sync=function(){throw new Error("sync method not implemented")},n}(),p;(function(n){n[n.HideMin=1]="HideMin",n[n.HideMax=2]="HideMax",n[n.HideMean=4]="HideMean",n[n.HideLast=8]="HideLast",n[n.HideGraph=16]="HideGraph",n[n.RoundValues=32]="RoundValues"})(p||(p={}));var Me=function(n){Fe(e,n);function e(t,a,l,s){var i=n.call(this,t)||this;i.flags=a,i.unitName=l,i.samples=s;var r=document.createElement("div");r.style.cssText="text-align: center",r.textContent=i.name;var o=document.createElement("div");return a&p.HideMin?i.minText=null:(i.minText=document.createElement("div"),o.appendChild(i.minText)),a&p.HideMax?i.maxText=null:(i.maxText=document.createElement("div"),o.appendChild(i.maxText)),a&p.HideMean?i.meanText=null:(i.meanText=document.createElement("div"),o.appendChild(i.meanText)),a&p.HideLast?i.lastText=null:(i.lastText=document.createElement("div"),o.appendChild(i.lastText)),i.element.appendChild(r),i.element.appendChild(o),a&p.HideGraph?(i.canvas=null,i.ctx=null):(i.canvas=document.createElement("canvas"),i.canvas.style.cssText="display: block; padding: 0; margin: 0",i.canvas.width=Ye,i.canvas.height=se,i.ctx=i.canvas.getContext("2d"),i.element.appendChild(i.canvas)),i}return e.prototype.sync=function(){var t=this,a=this.samples.calc(),l=se/(a.max*1.2),s,i,r,o;this.flags&p.RoundValues?(s=Math.round(a.min).toString(),i=Math.round(a.max).toString(),r=Math.round(a.mean).toString(),o=Math.round(a.last).toString()):(s=a.min.toFixed(2),i=a.max.toFixed(2),r=a.mean.toFixed(2),o=a.last.toFixed(2)),this.minText!==null&&(this.minText.textContent="min: \xA0"+s+this.unitName),this.maxText!==null&&(this.maxText.textContent="max: \xA0"+i+this.unitName),this.meanText!==null&&(this.meanText.textContent="mean: "+r+this.unitName),this.lastText!==null&&(this.lastText.textContent="last: "+o+this.unitName),this.ctx!==null&&(this.ctx.fillStyle="#010",this.ctx.fillRect(0,0,Ye,se),this.ctx.fillStyle="#0f0",this.samples.each(function(c,d){t.ctx.fillRect(d,se,1,-(c*l))}))},e}(Be),Ht=function(n){Fe(e,n);function e(t,a){var l=n.call(this,t)||this;return l.counter=a,l.text=document.createElement("div"),l.element.appendChild(l.text),l}return e.prototype.sync=function(){this.text.textContent=this.name+": "+this.counter.value},e}(Be),j=null,Lt=!1;function Ue(){j||(j=document.createElement("div"),j.style.cssText="position: fixed;opacity: 0.9;right: 0;bottom: 0",document.body.appendChild(j)),Lt=!0}function Xe(n){n===void 0&&(n=p.HideMin|p.HideMax|p.HideMean|p.RoundValues),Ue();var e=new Se(re),t=new Me("FPS",n,"",e);j.appendChild(t.element);var a=2/121,l=0,s=60;function i(r){l>0&&(s+=a*(1e3/(r-l)-s)),l=r,e.addSample(s),t.invalidate(),requestAnimationFrame(i)}requestAnimationFrame(i)}function We(n){if(n===void 0&&(n=p.HideMin|p.HideMean),Ue(),performance.memory===void 0)return;var e=new Se(re),t=new Me("Memory",n,"MB",e);j.appendChild(t.element);function a(){e.addSample(Math.round(performance.memory.usedJSHeapSize/(1024*1024))),t.invalidate(),setTimeout(a,30)}a()}var un=function(){function n(e,t,a){this.data=new Se(re),this.widget=new Me(e,a,t,this.data),this.startTime=-1}return n}();var fn=function(){function n(e,t){var a=this;this.data=t===void 0?new Pt:new Et(t),this.widget=new Ht(e,this.data),this.data.onChange=function(){a.widget.invalidate()}}return n}();Je(we);Je(le);/[&?]perfmon=(false|off|0)\b/.test(location.search)||(Xe(),We());var $t=new we;document.body.appendChild($t);function Je(n){n.prototype.attachShadow=function(){return this.shadowRoot||Object.defineProperty(this,"shadowRoot",{value:this}),this}}
//# sourceMappingURL=index.js.map
